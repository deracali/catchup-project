<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../images/favicon.ico">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/icomoon-free@1.0.0/style.css">

    <title>CatchUp - Dashboard</title>
    
	<!-- Vendors Style-->
	<link rel="stylesheet" href="css/vendors_css.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	
	<!-- Style-->  
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/skin_color.css">
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<link rel="stylesheet" href="../assets/icons/icomoon/style.css"/>
  </head>
  <style>
	.bg-light-blue { background-color: #d9f1ff; }
	.bg-light-green { background-color: #d4f5d4; }
	.countnm { font-size: 50px; font-weight: bold; }
	.text-info { color: #17a2b8; }
</style>
<body class="hold-transition light-skin sidebar-mini theme-primary fixed">
	
<div class="wrapper">
	<div id="loader"></div>
	
  <header class="main-header">
	<div class="d-flex align-items-center logo-box justify-content-start">
		<a href="#" class="waves-effect waves-light nav-link d-none d-md-inline-block mx-10 push-btn bg-transparent" data-toggle="push-menu" role="button">
			<i class="fas fa-bars"></i>
		</a>
			
		<!-- Logo -->
		<a href="index.html" class="logo">
		  <!-- logo-->
		  <div class="logo-lg">
			  <span class="light-logo"><img src="../images/logo-dark-text.png" alt="logo"></span>
			  <span class="dark-logo"><img src="../images/logo-light-text.png" alt="logo"></span>
		  </div>
		</a>	
	</div>  
    <!-- Header Navbar -->
	 
    <nav class="navbar navbar-static-top">
      <!-- Sidebar toggle button-->
	  <div class="app-menu">
	
	  </div>
		
      <div class="navbar-custom-menu r-side">
		<ul class="nav navbar-nav">    
		
			
		
			
		  
	      <!-- User Account-->
		  <li class="dropdown user user-menu">
			<a href="#" class="waves-effect waves-light dropdown-toggle" data-bs-toggle="dropdown" title="User">
				<i class="fas fa-user"></i>
			</a>
			<ul class="dropdown-menu animated flipInX">
				<li class="user-body">
					
					<a class="dropdown-item" href="#"><i class="fas fa-lock text-muted me-2"></i> Logout</a>
				</li>
			</ul>
		</li>    
		
		
        </ul>
      </div>
    </nav>
  </header>
  
  <aside class="main-sidebar">
    <!-- sidebar-->
	<section class="sidebar position-relative">    
		<div class="multinav">
			<div class="multinav-scroll" style="height: 100%;">    
				<!-- sidebar menu-->
				<ul class="sidebar-menu" data-widget="tree">    
					<li class="header">Dashboard & Apps</li>
					<li class="treeview">	
							<span class="pull-right-container">
						
								<li><a href="index2.html"><i class="fas fa-chart-line"></i> Dashboard</a></li>
							</span>
							<li><a href="offlinecourseform.html"><i class="fas fa-plus-circle"></i> Create Offline Course</a></li>
							<li><a href="quizform.html"><i class="fas fa-poll"></i> Create Quiz</a></li>
							<li><a href="quizTables.html"><i class="fas fa-list"></i> Quiz List</a></li>
									<li><a href="offlinecoursesTable.html"><i class="fas fa-book"></i> Offline Courses List</a></li>
									<li><a href="teacherReview.html"><i class="fas fa-star"></i> Teachers Review</a></li>
									<li><a href="contact_userlist_grid.html"><i class="fas fa-chalkboard-teacher"></i> Teachers</a></li>
									<li><a href="contact_userlist.html"><i class="fas fa-user-graduate"></i> Students</a></li>    
								</li>   
				</ul>
			</div>
		</div>
	</section>

  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
	  <div class="container-full">
		<!-- Main content -->
		<section class="content">
			<div class="row">
				<div class="col-xl-8">														
					<div class="box no-shadow mb-0 bg-transparent">
						<div class="box-header no-border px-0">
							<h4 class="box-title">Your Courses</h4>							
							<div class="box-controls pull-right d-md-flex d-none">
							  
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-lg-4 col-12">
							<a href="#" class="box pull-up">
								<div class="box-body">
									<div class="d-flex align-items-center">
										<div class="icon bg-primary-light rounded-circle w-60 h-60 text-center l-h-80">
											<span class="fs-30 icon-Users"></span>
										</div>
										<div class="ms-15">                                             
											<h5 class="mb-0">Total Students</h5>
											<p class="text-fade fs-12 mb-0" id="studentCount">Loading...</p>
										</div>
									</div>
								</div>
							</a>
						</div>
						
						<div class="col-lg-4 col-12">
							<a href="#" class="box pull-up">
								<div class="box-body">
									<div class="d-flex align-items-center">
										<div class="icon bg-primary-light rounded-circle w-60 h-60 text-center l-h-80">
											<span class="fs-30 icon-Teacher"></span>
										</div>
										<div class="ms-15">                                             
											<h5 class="mb-0">Total Teachers</h5>
											<p class="text-fade fs-12 mb-0" id="teacherCount">Loading...</p>
										</div>
									</div>
								</div>
							</a>
						</div>
						
						<div class="col-lg-4 col-12">
							<a href="#" class="box pull-up">
								<div class="box-body">
									<div class="d-flex align-items-center">
										<div class="icon bg-primary-light rounded-circle w-60 h-60 text-center l-h-80">
											<span class="fs-30 icon-Review"></span>
										</div>
										<div class="ms-15">                                             
											<h5 class="mb-0">Teacher Reviews</h5>
											<p class="text-fade fs-12 mb-0" id="reviewCount">Loading...</p>
										</div>
									</div>
								</div>
							</a>
						</div>
						
						<div class="col-lg-6 col-12">
							<div class="box">
								<div class="box-header">
									<h4 class="box-title">Updates</h4>
								</div>
								<div class="box-body">
									<h3>Daily Updates</h3>
									<div class="act-div" id="latest-activity">
										<p>Loading activity...</p>
									</div>
								</div>
							
								<div class="box-footer text-center p-0">
									<a href="#" class="btn d-grid btn-primary-light">View all</a>
								</div>
							</div>
						</div>
						<div class="col-lg-6">
							<div class="box">
								<div class="box-header">
									<h4 class="box-title">Statisics</h4>
								</div>
								<div class="box-body">
									<h3 class="mt-0">24hr</h3>
									<p class="text-fade fs-12">Users Signed Up (Last 7 Days)</p>
									<canvas id="charts_widget_2_chart"></canvas>
								</div>
							</div>
							<div class="row">
								<!-- Offline Courses Count -->
								<div class="col-6">
									<a class="box bg-light-blue" href="javascript:void(0)">
										<p class="fw-600 text-info">Offline Courses</p>
										<h1 id="offline-course-count" class="countnm">0</h1>
									</a>
								</div>
						
								<!-- Quiz Count -->
								<div class="col-6">
									<a class="box bg-light-green" href="javascript:void(0)">
										<p class="fw-600 text-info">Total Quizzes</p>
										<h1 id="quiz-count" class="countnm">0</h1>
									</a>
								</div>
							</div>
						</div>
					</div>
					<div class="box">
						<div class="box-header">
							<h4 class="box-title">Activity Statistics</h4>
							<ul class="box-controls pull-right d-md-flex d-none">
								<li class="dropdown">
									<button class="dropdown-toggle btn btn-warning-light px-10" data-bs-toggle="dropdown" href="#" aria-expanded="false">Monthly</button>
									<div class="dropdown-menu dropdown-menu-end">
										<a class="dropdown-item active" href="#">Today</a>
										<a class="dropdown-item" href="#">Yesterday</a>
										<a class="dropdown-item" href="#">Last week</a>
										<a class="dropdown-item" href="#">Last month</a>
									</div>
								</li>
							</ul>
						</div>
						<div class="box-body">
							<canvas id="charts_widget_1_chart"></canvas>
						</div>
					</div>
					<div class="row">
						<div class="col-lg-6 col-12">
							<a href="#" class="box bg-danger bg-hover-danger pull-up">
								<div class="box-body">
									<div class="d-flex align-items-center">
										<div class="w-80 h-80 l-h-100 rounded-circle b-1 border-white text-center">
											<i class="fas fa-shopping-cart text-white fs-40"></i>
										</div>
										<div class="ms-10">
											<h4 class="text-white mb-0">+1 1234 456 789</h4>
											<h5 class="text-white-50 mb-0">Toll Free</h5>
										</div>
									</div>							
								</div>
							</a>
						</div>
						<div class="col-lg-6 col-12">
							<a href="#" class="box bg-primary bg-hover-primary pull-up">
								<div class="box-body">
									<div class="d-flex align-items-center">
										<div class="w-80 h-80 l-h-100 rounded-circle b-1 border-white text-center">
											<i class="fas fa-envelope text-white fs-40"></i>
										</div>
										<div class="ms-10">
											<h4 class="text-white mb-0">info@CatchUp.com</h4>
											<h5 class="text-white-50 mb-0">Free to Fill Us</h5>
										</div>
									</div>							
								</div>
							</a>
						</div>
					</div>
				</div>
				<div class="col-xl-4 col-12">										
					<div class="box no-shadow mb-0 bg-transparent">
						<div class="box-header no-border px-0">
							<h4 class="box-title">Latest Activity</h4>							
							<div class="box-controls pull-right d-md-flex d-none">
							  
							</div>
						</div>
					</div>
					<div>
						<div class="box bs-5 border-danger rounded mb-10 pull-up">
						 <!-- Latest Registered User -->
    <div class="box-body">
        <div class="flex-grow-1">
            <div class="d-flex align-items-center pe-2 justify-content-between">
                <h4 class="fw-500">Latest Registered User</h4>
            </div>
            <div id="latest-user" class="d-flex align-items-center mt-10">
                <p>Loading...</p>
            </div>
        </div>
    </div>
					</div>
    <!-- Latest Teacher Review -->
    <div class="box bs-5 border-primary rounded mb-10 pull-up">
        <div class="box-body">
            <div class="flex-grow-1">
                <div class="d-flex align-items-center pe-2 justify-content-between">
                    <h4 class="fw-500">Latest Teacher Review</h4>
                </div>
                <div id="latest-review" class="d-flex align-items-center mt-10">
                    <p>Loading...</p>
                </div>
            </div>
        </div>
    </div>
										
					<div class="box no-shadow mb-0 bg-transparent">
						<div class="box-header no-border px-0">
							<h4 class="box-title">Lessons</h4>							
							<div class="box-controls pull-right d-md-flex d-none">
							  
							</div>
						</div>
					</div>
					<div class="course-container">
						<h3>Recently Added Courses</h3>
						<div id="most-added-courses">
							<p>Loading courses...</p>
						</div>
					</div>
									
					<div class="box no-shadow mb-0 bg-transparent">
						<div class="box-header no-border px-0">
							<h4 class="box-title">Recent Live Course</h4>							
							<div class="box-controls pull-right d-md-flex d-none">
							  
							</div>
						</div>
					</div>
					<div id="live-course-container">
						<div class="card">
							<div class="min-h-310" style="background-image: url(../images/front-end-img/courses/1.jpg); background-position: center center; background-size: cover;"></div>
							<div class="card-body">
								<span class="badge badge-primary">Online</span>													
								<div class="cour-stac d-flex align-items-center text-fade mt-20">
									<p id="course-date">Start Date: TBA</p>
									<p class="lt-sp">|</p>
									<p id="course-time">Time: TBA</p>
								</div>
								<h4 id="course-title" class="card-title justify-content-between d-flex align-items-center">Loading...</h4>
								<p id="course-lessons" class="card-text">Lessons: 0</p>
							</div>
							<div class="card-footer justify-content-between d-flex align-items-center">
								<div class="d-flex fs-18 fw-600">
									<span id="course-price" class="text-dark me-10">$0</span> 
								</div>
								<span>
									<i class="fas fa-star text-warning"></i>
<i class="fas fa-star text-warning"></i>
<i class="fas fa-star text-warning"></i>
<i class="fas fa-star text-warning"></i>
<i class="fas fa-star-half-alt text-warning"></i>

									<span id="course-students" class="text-muted ms-2">(0 students)</span>
								</span>
							</div>
						</div>
					</div>
				
				</div>
			</div>
		</section>
		<!-- /.content -->
	  </div>
  </div>
  <!-- /.content-wrapper -->
  <footer class="main-footer">
   
	  &copy; 2025 All Rights Reserved Catchup.
  </footer>


  
  <!-- Add the sidebar's background. This div must be placed immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>
  
</div>
<!-- ./wrapper -->
	
	
<script>
	const adminToken = localStorage.getItem("adminToken");
	const adminId = localStorage.getItem("adminId");
  
	if (!adminToken || !adminId) {
	  window.location.href = "auth_login.html";
	}
  </script>
  
	
	
	<!-- Page Content overlay -->
	<script>
		document.addEventListener("DOMContentLoaded", async () => {
			try {
				const studentsRes = await fetch("https://catchup-project.onrender.com/api/users");
				const teachersRes = await fetch("https://catchup-project.onrender.com/api/teachers");
				const reviewsRes = await fetch("https://catchup-project.onrender.com/api/teacher-reviews");
	
				const students = await studentsRes.json();
				const teachers = await teachersRes.json();
				const reviews = await reviewsRes.json();
	
				document.getElementById("studentCount").textContent = students.length;
				document.getElementById("teacherCount").textContent = teachers.length;
				document.getElementById("reviewCount").textContent = reviews.length;
			} catch (error) {
				console.error("Error fetching data:", error);
				document.getElementById("studentCount").textContent = "Error";
				document.getElementById("teacherCount").textContent = "Error";
				document.getElementById("reviewCount").textContent = "Error";
			}
		});
	</script>
	
	




	<script>
        document.addEventListener("DOMContentLoaded", function () {
            const defaultUserAvatar = "https://www.w3schools.com/howto/img_avatar.png"; // Default user avatar
            const defaultTeacherAvatar = "https://cdn-icons-png.flaticon.com/512/201/201634.png"; // Default teacher avatar

            // Fetch latest registered user
            fetch("https://catchup-project.onrender.com/api/users")
                .then(response => response.json())
                .then(users => {
                    if (users.length > 0) {
                        const latestUser = users.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))[0];
                        const userImage = latestUser.image && latestUser.image.trim() ? latestUser.image : defaultUserAvatar;
                        document.getElementById("latest-user").innerHTML = `
                            <img src="${userImage}" alt="User Avatar" class="h-50 w-50 rounded-circle me-10">
                            <div>
                                <strong>${latestUser.name}</strong> <br>
                                <small>Registered: ${new Date(latestUser.createdAt).toLocaleString()}</small>
                            </div>
                        `;
                    } else {
                        document.getElementById("latest-user").innerText = "No users found.";
                    }
                })
                .catch(error => console.error("Error fetching users:", error));

            // Fetch latest teacher review
            fetch("https://catchup-project.onrender.com/api/teacher-reviews")
                .then(response => response.json())
                .then(reviews => {
                    if (reviews.length > 0) {
                        const latestReview = reviews.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))[0];
                        const teacherImage = latestReview.profileImage && latestReview.profileImage.trim() ? latestReview.profileImage : defaultTeacherAvatar;
                        document.getElementById("latest-review").innerHTML = `
                            <img src="${teacherImage}" alt="Teacher Avatar" class="h-50 w-50 rounded-circle me-10">
                            <div>
                                <strong>${latestReview.name} (${latestReview.designation})</strong> <br>
                                <small>Review Rating: ⭐ ${latestReview.rating} / 5</small> <br>
                                <small>Registered: ${new Date(latestReview.createdAt).toLocaleString()}</small>
                            </div>
                        `;
                    } else {
                        document.getElementById("latest-review").innerText = "No reviews found.";
                    }
                })
                .catch(error => console.error("Error fetching reviews:", error));
        });
    </script>








<script>
	document.addEventListener("DOMContentLoaded", function () {
		const courseContainer = document.getElementById("most-added-courses");
		const defaultCourseIcon = "https://cdn-icons-png.flaticon.com/512/3135/3135715.png"; // Default icon

		// Fetch most added courses from API
		fetch("https://catchup-project.onrender.com/api/offlinecourse")
			.then(response => response.json())
			.then(courses => {
				if (courses.length === 0) {
					courseContainer.innerHTML = "<p>No courses available.</p>";
					return;
				}

				// Sort courses by createdAt (newest first)
				courses.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

				// Generate HTML
				courseContainer.innerHTML = courses.slice(0, 5).map(course => `
					<div class="box mb-15 pull-up">
						<div class="box-body">
							<div class="d-flex align-items-center justify-content-between">
								<div class="d-flex align-items-center">
									<div class="me-15 bg-warning-light h-50 w-50 l-h-60 rounded text-center">
										<img src="${course.courseImage || defaultCourseIcon}" alt="Course Image" class="h-50 w-50 rounded">
									</div>
									<div class="d-flex flex-column fw-500">
										<a href="#" class="text-dark hover-primary mb-1 fs-16">${course.title}</a>
										<span class="text-fade">${course.instructor.name}, ${new Date(course.createdAt).toLocaleDateString()}</span>
									</div>
								</div>
								<a href="#">
									<span class="fs-24">
  <i class="fas fa-arrow-right"></i>
</span>

								</a>
							</div>
						</div>
					</div>
				`).join("");
			})
			.catch(error => {
				console.error("Error fetching courses:", error);
				courseContainer.innerHTML = "<p>Failed to load courses.</p>";
			});
	});
</script>








<script>
	document.addEventListener("DOMContentLoaded", async function () {
		const activityContainer = document.getElementById("latest-activity");
		const defaultAvatar = "https://cdn-icons-png.flaticon.com/512/3135/3135715.png"; // Default avatar

		try {
			const [usersRes, teachersRes, reviewsRes, coursesRes] = await Promise.all([
				fetch("https://catchup-project.onrender.com/api/users").then(res => res.json()),
				fetch("https://catchup-project.onrender.com/api/teacher-reviews").then(res => res.json()),
				fetch("https://catchup-project.onrender.com/api/teachers").then(res => res.json()),
				fetch("https://catchup-project.onrender.com/api/offlinecourse").then(res => res.json()),
			]);

			let activities = [];

			// Users Activity
			usersRes.forEach(user => {
				activities.push({
					type: "User",
					message: `New user registered: ${user.name}`,
					date: user.createdAt,
					user: user.name,
					avatar: user.profileImage || defaultAvatar
				});
			});

			// Teachers Activity (Accepted / Rejected)
			teachersRes.forEach(teacher => {
				activities.push({
					type: "Teacher",
					message: `Teacher ${teacher.name} was ${teacher.acceptedOrRejected.toLowerCase()}`,
					date: teacher.createdAt,
					user: teacher.name,
					avatar: teacher.profileImage || defaultAvatar
				});
			});

			// Teacher Reviews
			reviewsRes.forEach(review => {
				activities.push({
					type: "Review",
					message: `New review for ${review.name} - Rated ${review.rating}★`,
					date: review.createdAt,
					user: review.name,
					avatar: review.profileImage || defaultAvatar
				});
			});

			// Courses Activity
			coursesRes.forEach(course => {
				activities.push({
					type: "Course",
					message: `New course added: ${course.title}`,
					date: course.createdAt,
					user: course.instructor.name,
					avatar: course.instructor.image || defaultAvatar
				});
			});

			// Sort by date (latest first)
			activities.sort((a, b) => new Date(b.date) - new Date(a.date));

			// Generate HTML
			activityContainer.innerHTML = activities.map(activity => `
				<div class="bg-gray-100 p-15 rounded10 mb-20">
					<div>
						<span class="badge badge-sm badge-dot ${activity.type === 'Course' ? 'badge-warning' : 'badge-primary'} me-5"></span>
						${activity.type}
					</div>
					<h4 class="my-20">${activity.message}</h4>
					<div class="d-flex align-items-center justify-content-between">
						<div class="d-flex align-items-center">
							<img src="${activity.avatar}" class="avatar avatar-sm me-10 avatar-pill">
							<p class="text-fade fs-12 mb-0">${activity.user}</p>
						</div>
						<p class="text-fade fs-12 mb-0">${new Date(activity.date).toLocaleDateString()}</p>
					</div>
				</div>
			`).join("");

		} catch (error) {
			console.error("Error fetching activities:", error);
			activityContainer.innerHTML = "<p>Failed to load activity.</p>";
		}
	});
</script>










<script>
	document.addEventListener("DOMContentLoaded", async function () {
		const ctx = document.getElementById("charts_widget_2_chart").getContext("2d");

		try {
			// Fetch users data
			const usersRes = await fetch("https://catchup-project.onrender.com/api/users");
			const users = await usersRes.json();

			// Process user sign-ups per day
			const signups = {};
			const now = new Date();

			// Initialize past 7 days with zero counts
			for (let i = 6; i >= 0; i--) {
				const date = new Date(now);
				date.setDate(now.getDate() - i);
				const dateString = date.toISOString().split("T")[0]; // YYYY-MM-DD
				signups[dateString] = 0;
			}

			// Count sign-ups per day
			users.forEach(user => {
				const createdAt = new Date(user.createdAt).toISOString().split("T")[0]; // YYYY-MM-DD
				if (signups.hasOwnProperty(createdAt)) {
					signups[createdAt]++;
				}
			});

			// Prepare data for Chart.js
			const labels = Object.keys(signups);
			const data = Object.values(signups);

			// Generate chart
			new Chart(ctx, {
				type: "bar",
				data: {
					labels,
					datasets: [{
						label: "Users Signed Up",
						data,
						backgroundColor: "rgba(75, 192, 192, 0.6)",
						borderColor: "rgba(75, 192, 192, 1)",
						borderWidth: 1
					}]
				},
				options: {
					responsive: true,
					scales: {
						y: { beginAtZero: true }
					}
				}
			});

		} catch (error) {
			console.error("Error fetching sign-up data:", error);
			document.getElementById("charts_widget_2_chart").innerHTML = "<p>Failed to load chart.</p>";
		}
	});
</script>







<script>
	document.addEventListener("DOMContentLoaded", async function () {
		try {
			// Fetch the total count of offline courses
			const offlineCourseRes = await fetch("https://catchup-project.onrender.com/api/offlinecourse");
			const offlineCourses = await offlineCourseRes.json();
			const totalOfflineCourses = offlineCourses.length; // Count courses
			
			// Fetch the total count of quizzes
			const quizRes = await fetch("https://catchup-project.onrender.com/api/quiz");
			const quizzes = await quizRes.json();
			const totalQuizzes = quizzes.length; // Count quizzes

			// Update UI
			document.getElementById("offline-course-count").innerText = totalOfflineCourses;
			document.getElementById("quiz-count").innerText = totalQuizzes;

		} catch (error) {
			console.error("Error fetching data:", error);
			document.getElementById("offline-course-count").innerText = "Error";
			document.getElementById("quiz-count").innerText = "Error";
		}
	});
</script>
	<!-- Vendor JS -->
	<script src="js/vendors.min.js"></script>
	<script src="js/pages/chat-popup.js"></script>
    <script src="../assets/icons/feather-icons/feather.min.js"></script>	

	<script src="../assets/vendor_components/apexcharts-bundle/dist/apexcharts.js"></script>
	
	<!-- CatchUp App -->
	<script src="js/template.js"></script>
	<script src="js/pages/dashboard2.js"></script>
	











	<script>
        document.addEventListener("DOMContentLoaded", async function () {
            try {
                // Fetch user sign-ups
                const userRes = await fetch("https://catchup-project.onrender.com/api/users");
                const users = await userRes.json();
                
                // Fetch teacher applications
                const teacherRes = await fetch("https://catchup-project.onrender.com/api/teacher-reviews");
                const teachers = await teacherRes.json();

                // Function to group data by date
                function groupByDate(data) {
                    return data.reduce((acc, item) => {
                        const date = new Date(item.createdAt).toISOString().split("T")[0]; // Extract YYYY-MM-DD
                        acc[date] = (acc[date] || 0) + 1;
                        return acc;
                    }, {});
                }

                const userActivity = groupByDate(users);
                const teacherActivity = groupByDate(teachers);

                // Combine both activities into one timeline
                const allDates = [...new Set([...Object.keys(userActivity), ...Object.keys(teacherActivity)])].sort();
                
                const userCounts = allDates.map(date => userActivity[date] || 0);
                const teacherCounts = allDates.map(date => teacherActivity[date] || 0);

                // Render Chart.js
                const ctx = document.getElementById("charts_widget_1_chart").getContext("2d");
                new Chart(ctx, {
                    type: "line",
                    data: {
                        labels: allDates,
                        datasets: [
                            {
                                label: "User Sign-ups",
                                data: userCounts,
                                borderColor: "blue",
                                backgroundColor: "rgba(0, 0, 255, 0.2)",
                                fill: true
                            },
                            {
                                label: "Teacher Applications",
                                data: teacherCounts,
                                borderColor: "orange",
                                backgroundColor: "rgba(255, 165, 0, 0.2)",
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { position: "top" } },
                        scales: {
                            x: { title: { display: true, text: "Date" } },
                            y: { title: { display: true, text: "Number of Activities" } }
                        }
                    }
                });

            } catch (error) {
                console.error("Error fetching activity data:", error);
                document.getElementById("charts_widget_1_chart").innerHTML = "<p>Error loading chart data</p>";
            }
        });
    </script>
   





<script>
        document.addEventListener("DOMContentLoaded", async function () {
            try {
                // Fetch the latest live course
                const response = await fetch("https://catchup-project.onrender.com/api/livecourses/get");
                const courses = await response.json();

                if (!courses.length) {
                    document.getElementById("live-course-container").innerHTML = "<p>No live courses available.</p>";
                    return;
                }

                // Sort courses by createdAt (latest first)
                courses.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                const latestCourse = courses[0]; // Get the most recent course

                // Populate the course card
                document.getElementById("course-title").innerText = latestCourse.title || "Untitled Course";
                document.getElementById("course-date").innerText = `Start Date: ${latestCourse.date || "TBA"}`;
                document.getElementById("course-time").innerText = `Time: ${latestCourse.time || "TBA"}`;
                document.getElementById("course-lessons").innerText = `Lessons: ${latestCourse.lessonCount || 0}`;
                document.getElementById("course-students").innerText = `(${latestCourse.studentsCount || 0} students)`;
                
            } catch (error) {
                console.error("Error fetching live course:", error);
                document.getElementById("live-course-container").innerHTML = "<p>Error loading course data.</p>";
            }
        });
    </script>
</body>
</html>
