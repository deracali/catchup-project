<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../images/favicon.ico">

    <title>CatchUp - Dashboard  Forms </title>
  
	<!-- Vendors Style-->
	<link rel="stylesheet" href="css/vendors_css.css">
	  
	<!-- Style-->  
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/skin_color.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	
</head>
<body class="hold-transition light-skin sidebar-mini theme-primary fixed">
	
<div class="wrapper">
	<div id="loader"></div>

  	
	<header class="main-header">
		<div class="d-flex align-items-center logo-box justify-content-start">
			<a href="#" class="waves-effect waves-light nav-link d-none d-md-inline-block mx-10 push-btn bg-transparent" data-toggle="push-menu" role="button">
				<i class="fas fa-bars"></i>
			</a>
				
			<!-- Logo -->
			<a href="index.html" class="logo">
			  <!-- logo-->
			  <div class="logo-lg">
				  <span class="light-logo"><img src="../images/logo-dark-text.png" alt="logo"></span>
				  <span class="dark-logo"><img src="../images/logo-light-text.png" alt="logo"></span>
			  </div>
			</a>	
		</div>  
		<!-- Header Navbar -->
		 
		<nav class="navbar navbar-static-top">
		  <!-- Sidebar toggle button-->
		  <div class="app-menu">
		
		  </div>
			
		  <div class="navbar-custom-menu r-side">
			<ul class="nav navbar-nav">    
			
				
			
				
			  
			  <!-- User Account-->
			  <li class="dropdown user user-menu">
				<a href="#" class="waves-effect waves-light dropdown-toggle" data-bs-toggle="dropdown" title="User">
					<i class="fas fa-user"></i>
				</a>
				<ul class="dropdown-menu animated flipInX">
					<li class="user-body">
						<a class="dropdown-item" href="#"><i class="fas fa-user text-muted me-2"></i> Profile</a>
						<a class="dropdown-item" href="#"><i class="fas fa-wallet text-muted me-2"></i> My Wallet</a>
						<a class="dropdown-item" href="#"><i class="fas fa-cog text-muted me-2"></i> Settings</a>
						<div class="dropdown-divider"></div>
						<a class="dropdown-item" href="#"><i class="fas fa-lock text-muted me-2"></i> Logout</a>
					</li>
				</ul>
			</li>    
			
			
			</ul>
		  </div>
		</nav>
	  </header>
	  
	  <aside class="main-sidebar">
		<!-- sidebar-->
		<section class="sidebar position-relative">    
			<div class="multinav">
				<div class="multinav-scroll" style="height: 100%;">    
					<!-- sidebar menu-->
				<ul class="sidebar-menu" data-widget="tree">    
					<li class="header">Dashboard & Apps</li>
					<li class="treeview">	
							<span class="pull-right-container">
						
								<li><a href="index2.html"><i class="fas fa-chart-line"></i> Dashboard</a></li>
							</span>
							<li><a href="offlinecourseform.html"><i class="fas fa-plus-circle"></i> Create Offline Course</a></li>
							<li><a href="quizform.html"><i class="fas fa-poll"></i> Create Quiz</a></li>
							<li><a href="quizTables.html"><i class="fas fa-list"></i> Quiz List</a></li>
									<li><a href="offlinecoursesTable.html"><i class="fas fa-book"></i> Offline Courses List</a></li>
									<li><a href="teacherReview.html"><i class="fas fa-star"></i> Teachers Review</a></li>
									<li><a href="contact_userlist_grid.html"><i class="fas fa-chalkboard-teacher"></i> Teachers</a></li>
									<li><a href="contact_userlist.html"><i class="fas fa-user-graduate"></i> Students</a></li>    
								</li>   
				</ul>
				</div>
			</div>
		</section>
		<div class="sidebar-footer">
			<a href="javascript:void(0)" class="link" data-bs-toggle="tooltip" title="Settings"><span class="icon-Settings-2"></span></a>
			<a href="mailbox.html" class="link" data-bs-toggle="tooltip" title="Email"><span class="icon-Mail"></span></a>
			<a href="javascript:void(0)" class="link" data-bs-toggle="tooltip" title="Logout"><span class="icon-Lock-overturning"><span class="path1"></span><span class="path2"></span></span></a>
		</div>
	  </aside>
  
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
	  <div class="container-full">
		<!-- Content Header (Page header) -->
		<div class="content-header">
			<div class="d-flex align-items-center">
				<div class="me-auto">
					<h3 class="page-title">Forms</h3>
					<div class="d-inline-block align-items-center">
						<nav>
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="#"><i class="fas fa-home"></i></a></li>
								<li class="breadcrumb-item" aria-current="page">Forms</li>
								<li class="breadcrumb-item active" aria-current="page">Forms</li>
							</ol>
						</nav>
					</div>
				</div>
				
			</div>
		</div>	  

		<!-- Main content -->
		<section class="content">

	

		

		  <!-- Validation wizard -->
		  <div class="box-body">
			<form id="teacherForm">
				<div class="form-group">
					<label>Name:</label>
					<input type="text" id="teacherName" class="form-control" readonly>
				</div>
				<div class="form-group">
					<label>Email:</label>
					<input type="email" id="teacherEmail" class="form-control" readonly>
				</div>
				<div class="form-group">
					<label>Password:</label>
					<input type="password" id="teacherPassword" class="form-control">
				</div>
				<div class="form-group">
					<label>Phone:</label>
					<input type="text" id="teacherPhone" class="form-control" readonly>
				</div>
				<div class="form-group">
					<label>Address:</label>
					<input type="text" id="teacherAddress" class="form-control" readonly>
				</div>
				<div class="form-group">
					<label>Designation:</label>
					<input type="text" id="teacherDesignation" class="form-control" readonly>
				</div>
				<div class="form-group">
					<label>About:</label>
					<textarea id="teacherAbout" class="form-control" readonly></textarea>
				</div>
				<div class="form-group">
					<label>Courses:</label>
					<select id="teacherCourses" class="form-control" multiple>
						<!-- Courses will be dynamically inserted here -->
					</select>
				</div>
				<div class="form-group">
					<label>Download CV:</label><br>
					<a id="cvDownload" href="#" class="btn btn-primary" target="_blank">Download</a>
				</div>
				<input type="hidden" id="status" value="Pending">
				
				<!-- Buttons -->
				<button type="button" id="acceptBtn" class="btn btn-success">Accept</button>
				<button type="button" id="cancelBtn" class="btn btn-danger">Cancel</button>
				<button type="button" id="submitBtn" class="btn btn-primary">Submit</button>
				
				<!-- Status Text -->
				<p id="statusText"></p>
			</form>
		</div>
		
		
		  <!-- /.box -->

		</section>
		<!-- /.content -->
	  </div>
  </div>
  <!-- /.content-wrapper -->
  
   <footer class="main-footer">
   
	  &copy; 2025 All Rights Reserved Catchup.
  </footer>

  
  <!-- Add the sidebar's background. This div must be placed immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->
	
	
	
<script>
	const adminToken = localStorage.getItem("adminToken");
	const adminId = localStorage.getItem("adminId");
  
	if (!adminToken || !adminId) {
	  window.location.href = "auth_login.html";
	}
  </script>
  
	
	<!-- Page Content overlay -->
	<script>
		document.addEventListener("DOMContentLoaded", async () => {
			const urlParams = new URLSearchParams(window.location.search);
			const teacherId = urlParams.get("id");
		
			if (!teacherId) {
				alert("No teacher ID found in the URL.");
				return;
			}
		
			try {
				const response = await fetch(`https://catchup-project.onrender.com/api/teacher-reviews/get/${teacherId}`);
				if (!response.ok) throw new Error("Teacher not found");
		
				const teacher = await response.json();
		
				// Populate form fields
				document.getElementById("teacherName").value = teacher.name;
				document.getElementById("teacherEmail").value = teacher.email;
				document.getElementById("teacherPhone").value = teacher.phone;
				document.getElementById("teacherAddress").value = teacher.address;
				document.getElementById("teacherDesignation").value = teacher.designation;
				document.getElementById("teacherAbout").value = teacher.about;
				document.getElementById("cvDownload").href = teacher.cv;
		
				const courseList = document.getElementById("teacherCourses");
				teacher.courses.forEach(course => {
					const courseOption = document.createElement("option");
					courseOption.value = course;
					courseOption.textContent = course;
					courseList.appendChild(courseOption);
				});
		
				// Accept or Reject buttons
				document.getElementById("acceptBtn").addEventListener("click", () => {
					document.getElementById("status").value = "Accepted";
					document.getElementById("statusText").textContent = "Sending...";
				});
		
				document.getElementById("cancelBtn").addEventListener("click", () => {
					document.getElementById("status").value = "Rejected";
					document.getElementById("statusText").textContent = "Sending...";
				});
		
				// Submit form to register and update review status
				document.getElementById("submitBtn").addEventListener("click", async () => {
					const status = document.getElementById("status").value;
		
					const data = {
						name: document.getElementById("teacherName").value,
						email: document.getElementById("teacherEmail").value,
						phone: document.getElementById("teacherPhone").value,
						address: document.getElementById("teacherAddress").value,
						designation: document.getElementById("teacherDesignation").value,
						about: document.getElementById("teacherAbout").value,
						acceptedOrRejected: status,
						cv: teacher.cv,
						password: teacher.password,
						profileImage: teacher.profileImage,
						courses: teacher.courses
					};
		
					document.getElementById("statusText").textContent = "Sending...";
		
					try {
						// 1. Register teacher
						const registerResponse = await fetch("https://catchup-project.onrender.com/api/teachers/register", {
							method: "POST",
							headers: { "Content-Type": "application/json" },
							body: JSON.stringify(data),
						});
		
						if (!registerResponse.ok) {
							throw new Error("Failed to register teacher.");
						}
		
						// 2. Update teacher-review status
						const updateStatus = await fetch(`https://catchup-project.onrender.com/api/teacher-reviews/status/${teacherId}`, {
							method: "PATCH",
							headers: { "Content-Type": "application/json" },
							body: JSON.stringify({ status }),
						});
		
						if (!updateStatus.ok) {
							throw new Error("Failed to update teacher review status.");
						}
		
						alert("Teacher registered and status updated successfully!");
						window.location.href = "/catchup/index2.html";
					} catch (error) {
						console.error("Error:", error);
						alert("An error occurred while processing the request.");
					}
				});
		
			} catch (error) {
				console.error("Error fetching teacher details:", error);
				alert("Error loading teacher details.");
			}
		});
		</script>
		
	<!-- Vendor JS -->
	<script src="js/vendors.min.js"></script>
	<script src="js/pages/chat-popup.js"></script>
    <script src="../assets/icons/feather-icons/feather.min.js"></script>	<script src="../assets/vendor_components/jquery-steps-master/build/jquery.steps.js"></script>
    <script src="../assets/vendor_components/jquery-validation-1.17.0/dist/jquery.validate.min.js"></script>
    <script src="../assets/vendor_components/sweetalert/sweetalert.min.js"></script>
	
	<!-- CatchUp App -->
	<script src="js/template.js"></script>
	
    <script src="js/pages/steps.js"></script>
	
    
	
</body>
</html>
